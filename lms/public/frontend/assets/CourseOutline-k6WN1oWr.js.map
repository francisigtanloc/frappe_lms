{"version":3,"file":"CourseOutline-k6WN1oWr.js","sources":["../../../../frontend/node_modules/lucide-vue-next/dist/esm/icons/help-circle.js","../../../../frontend/node_modules/lucide-vue-next/dist/esm/icons/monitor-play.js","../../../../frontend/src/components/Modals/ChapterModal.vue","../../../../frontend/src/components/CourseOutline.vue"],"sourcesContent":["/**\n * @license lucide-vue-next v0.309.0 - ISC\n *\n * This source code is licensed under the ISC license.\n * See the LICENSE file in the root directory of this source tree.\n */\n\nimport createLucideIcon from '../createLucideIcon.js';\n\nconst HelpCircle = createLucideIcon(\"HelpCircleIcon\", [\n  [\"circle\", { cx: \"12\", cy: \"12\", r: \"10\", key: \"1mglay\" }],\n  [\"path\", { d: \"M9.09 9a3 3 0 0 1 5.83 1c0 2-3 3-3 3\", key: \"1u773s\" }],\n  [\"path\", { d: \"M12 17h.01\", key: \"p32p05\" }]\n]);\n\nexport { HelpCircle as default };\n//# sourceMappingURL=help-circle.js.map\n","/**\n * @license lucide-vue-next v0.309.0 - ISC\n *\n * This source code is licensed under the ISC license.\n * See the LICENSE file in the root directory of this source tree.\n */\n\nimport createLucideIcon from '../createLucideIcon.js';\n\nconst MonitorPlay = createLucideIcon(\"MonitorPlayIcon\", [\n  [\"path\", { d: \"m10 7 5 3-5 3Z\", key: \"29ljg6\" }],\n  [\"rect\", { width: \"20\", height: \"14\", x: \"2\", y: \"3\", rx: \"2\", key: \"48i651\" }],\n  [\"path\", { d: \"M12 17v4\", key: \"1riwvh\" }],\n  [\"path\", { d: \"M8 21h8\", key: \"1ev6f3\" }]\n]);\n\nexport { MonitorPlay as default };\n//# sourceMappingURL=monitor-play.js.map\n","<template>\n\t<Dialog\n\t\tv-model=\"show\"\n\t\t:options=\"{\n\t\t\ttitle: __('Add Chapter'),\n\t\t\tsize: 'lg',\n\t\t\tactions: [\n\t\t\t\t{\n\t\t\t\t\tlabel: chapterDetail ? __('Edit Chapter') : __('Add Chapter'),\n\t\t\t\t\tvariant: 'solid',\n\t\t\t\t\tonClick: (close) =>\n\t\t\t\t\t\tchapterDetail ? editChapter(close) : addChapter(close),\n\t\t\t\t},\n\t\t\t],\n\t\t}\"\n\t>\n\t\t<template #body-content>\n\t\t\t<FormControl label=\"Title\" v-model=\"chapter.title\" class=\"mb-4\" />\n\t\t</template>\n\t</Dialog>\n</template>\n<script setup>\nimport { Dialog, FormControl, createResource } from 'frappe-ui'\nimport { defineModel, reactive, watch, inject } from 'vue'\nimport { createToast, formatTime } from '@/utils/'\n\nconst show = defineModel()\nconst outline = defineModel('outline')\n\nconst props = defineProps({\n\tcourse: {\n\t\ttype: String,\n\t\trequired: true,\n\t},\n\tchapterDetail: {\n\t\ttype: Object,\n\t},\n})\nconst chapter = reactive({\n\ttitle: '',\n})\n\nconst chapterResource = createResource({\n\turl: 'frappe.client.insert',\n\tmakeParams(values) {\n\t\treturn {\n\t\t\tdoc: {\n\t\t\t\tdoctype: 'Course Chapter',\n\t\t\t\ttitle: chapter.title,\n\t\t\t\tdescription: chapter.description,\n\t\t\t\tcourse: props.course,\n\t\t\t},\n\t\t}\n\t},\n})\n\nconst chapterEditResource = createResource({\n\turl: 'frappe.client.set_value',\n\tmakeParams(values) {\n\t\treturn {\n\t\t\tdoctype: 'Course Chapter',\n\t\t\tname: props.chapterDetail?.name,\n\t\t\tfieldname: 'title',\n\t\t\tvalue: chapter.title,\n\t\t}\n\t},\n})\n\nconst chapterReference = createResource({\n\turl: 'frappe.client.insert',\n\tmakeParams(values) {\n\t\treturn {\n\t\t\tdoc: {\n\t\t\t\tdoctype: 'Chapter Reference',\n\t\t\t\tchapter: values.name,\n\t\t\t\tparent: props.course,\n\t\t\t\tparenttype: 'LMS Course',\n\t\t\t\tparentfield: 'chapters',\n\t\t\t},\n\t\t}\n\t},\n})\n\nconst addChapter = (close) => {\n\tchapterResource.submit(\n\t\t{},\n\t\t{\n\t\t\tvalidate() {\n\t\t\t\tif (!chapter.title) {\n\t\t\t\t\treturn 'Title is required'\n\t\t\t\t}\n\t\t\t},\n\t\t\tonSuccess: (data) => {\n\t\t\t\tchapterReference.submit(\n\t\t\t\t\t{ name: data.name },\n\t\t\t\t\t{\n\t\t\t\t\t\tonSuccess(data) {\n\t\t\t\t\t\t\toutline.value.reload()\n\t\t\t\t\t\t\tcreateToast({\n\t\t\t\t\t\t\t\ttext: 'Chapter added successfully',\n\t\t\t\t\t\t\t\ticon: 'check',\n\t\t\t\t\t\t\t\ticonClasses: 'bg-green-600 text-white rounded-md p-px',\n\t\t\t\t\t\t\t})\n\t\t\t\t\t\t},\n\t\t\t\t\t\tonError(err) {\n\t\t\t\t\t\t\tshowError(err)\n\t\t\t\t\t\t},\n\t\t\t\t\t}\n\t\t\t\t)\n\t\t\t\tclose()\n\t\t\t},\n\t\t\tonError(err) {\n\t\t\t\tshowError(err)\n\t\t\t},\n\t\t}\n\t)\n}\n\nconst editChapter = (close) => {\n\tchapterEditResource.submit(\n\t\t{},\n\t\t{\n\t\t\tvalidate() {\n\t\t\t\tif (!chapter.title) {\n\t\t\t\t\treturn 'Title is required'\n\t\t\t\t}\n\t\t\t},\n\t\t\tonSuccess() {\n\t\t\t\toutline.value.reload()\n\t\t\t\tcreateToast({\n\t\t\t\t\ttext: 'Chapter updated successfully',\n\t\t\t\t\ticon: 'check',\n\t\t\t\t\ticonClasses: 'bg-green-600 text-white rounded-md p-px',\n\t\t\t\t})\n\t\t\t\tclose()\n\t\t\t},\n\t\t\tonError(err) {\n\t\t\t\tshowError(err)\n\t\t\t},\n\t\t}\n\t)\n}\n\nconst showError = (err) => {\n\tcreateToast({\n\t\ttitle: 'Error',\n\t\ttext: err.messages?.[0] || err,\n\t\ticon: 'x',\n\t\ticonClasses: 'bg-red-600 text-white rounded-md p-px',\n\t\tposition: 'top-center',\n\t\ttimeout: 10,\n\t})\n}\n\nwatch(\n\t() => props.chapterDetail,\n\t(newChapter) => {\n\t\tchapter.title = newChapter?.title\n\t}\n)\n</script>\n","<template>\n\t<div class=\"text-base\">\n\t\t<div\n\t\t\tv-if=\"title && (outline.data?.length || allowEdit)\"\n\t\t\tclass=\"grid grid-cols-[70%,30%] mb-4 px-3\"\n\t\t>\n\t\t\t<div class=\"font-semibold text-lg\">\n\t\t\t\t{{ __(title) }}\n\t\t\t</div>\n\t\t\t<Button size=\"sm\" v-if=\"allowEdit\" @click=\"openChapterModal()\">\n\t\t\t\t{{ __('Add Chapter') }}\n\t\t\t</Button>\n\t\t\t<!-- <span class=\"font-medium cursor-pointer\" @click=\"expandAllChapters()\">\n\t\t\t\t{{ expandAll ? __(\"Collapse all chapters\") : __(\"Expand all chapters\") }}\n\t\t\t</span> -->\n\t\t</div>\n\t\t<div\n\t\t\t:class=\"{\n\t\t\t\t'shadow rounded-md pt-2 px-2': showOutline && outline.data?.length,\n\t\t\t}\"\n\t\t>\n\t\t\t<Disclosure\n\t\t\t\tv-slot=\"{ open }\"\n\t\t\t\tv-for=\"(chapter, index) in outline.data\"\n\t\t\t\t:key=\"chapter.name\"\n\t\t\t\t:defaultOpen=\"openChapterDetail(chapter.idx)\"\n\t\t\t>\n\t\t\t\t<DisclosureButton ref=\"\" class=\"flex w-full p-2\">\n\t\t\t\t\t<ChevronRight\n\t\t\t\t\t\t:class=\"{\n\t\t\t\t\t\t\t'rotate-90 transform duration-200': open,\n\t\t\t\t\t\t\t'duration-200': !open,\n\t\t\t\t\t\t\topen: index == 1,\n\t\t\t\t\t\t}\"\n\t\t\t\t\t\tclass=\"h-4 w-4 text-gray-900 stroke-1 mr-2\"\n\t\t\t\t\t/>\n\t\t\t\t\t<div class=\"text-base text-left font-medium leading-5\">\n\t\t\t\t\t\t{{ chapter.title }}\n\t\t\t\t\t</div>\n\t\t\t\t</DisclosureButton>\n\t\t\t\t<DisclosurePanel>\n\t\t\t\t\t<div v-for=\"lesson in chapter.lessons\" :key=\"lesson.name\">\n\t\t\t\t\t\t<div class=\"outline-lesson pl-8 py-2\">\n\t\t\t\t\t\t\t<router-link\n\t\t\t\t\t\t\t\t:to=\"{\n\t\t\t\t\t\t\t\t\tname: allowEdit ? 'CreateLesson' : 'Lesson',\n\t\t\t\t\t\t\t\t\tparams: {\n\t\t\t\t\t\t\t\t\t\tcourseName: courseName,\n\t\t\t\t\t\t\t\t\t\tchapterNumber: lesson.number.split('.')[0],\n\t\t\t\t\t\t\t\t\t\tlessonNumber: lesson.number.split('.')[1],\n\t\t\t\t\t\t\t\t\t},\n\t\t\t\t\t\t\t\t}\"\n\t\t\t\t\t\t\t>\n\t\t\t\t\t\t\t\t<div class=\"flex items-center text-sm leading-5\">\n\t\t\t\t\t\t\t\t\t<MonitorPlay\n\t\t\t\t\t\t\t\t\t\tv-if=\"lesson.icon === 'icon-youtube'\"\n\t\t\t\t\t\t\t\t\t\tclass=\"h-4 w-4 text-gray-900 stroke-1 mr-2\"\n\t\t\t\t\t\t\t\t\t/>\n\t\t\t\t\t\t\t\t\t<HelpCircle\n\t\t\t\t\t\t\t\t\t\tv-else-if=\"lesson.icon === 'icon-quiz'\"\n\t\t\t\t\t\t\t\t\t\tclass=\"h-4 w-4 text-gray-900 stroke-1 mr-2\"\n\t\t\t\t\t\t\t\t\t/>\n\t\t\t\t\t\t\t\t\t<FileText\n\t\t\t\t\t\t\t\t\t\tv-else-if=\"lesson.icon === 'icon-list'\"\n\t\t\t\t\t\t\t\t\t\tclass=\"h-4 w-4 text-gray-900 stroke-1 mr-2\"\n\t\t\t\t\t\t\t\t\t/>\n\t\t\t\t\t\t\t\t\t{{ lesson.title }}\n\t\t\t\t\t\t\t\t\t<Check\n\t\t\t\t\t\t\t\t\t\tv-if=\"lesson.is_complete\"\n\t\t\t\t\t\t\t\t\t\tclass=\"h-4 w-4 text-green-500 stroke-1.5 ml-2\"\n\t\t\t\t\t\t\t\t\t/>\n\t\t\t\t\t\t\t\t</div>\n\t\t\t\t\t\t\t</router-link>\n\t\t\t\t\t\t</div>\n\t\t\t\t\t</div>\n\t\t\t\t\t<div v-if=\"allowEdit\" class=\"flex mt-2 mb-4 pl-8\">\n\t\t\t\t\t\t<router-link\n\t\t\t\t\t\t\t:to=\"{\n\t\t\t\t\t\t\t\tname: 'CreateLesson',\n\t\t\t\t\t\t\t\tparams: {\n\t\t\t\t\t\t\t\t\tcourseName: courseName,\n\t\t\t\t\t\t\t\t\tchapterNumber: chapter.idx,\n\t\t\t\t\t\t\t\t\tlessonNumber: chapter.lessons.length + 1,\n\t\t\t\t\t\t\t\t},\n\t\t\t\t\t\t\t}\"\n\t\t\t\t\t\t>\n\t\t\t\t\t\t\t<Button>\n\t\t\t\t\t\t\t\t{{ __('Add Lesson') }}\n\t\t\t\t\t\t\t</Button>\n\t\t\t\t\t\t</router-link>\n\t\t\t\t\t\t<Button class=\"ml-2\" @click=\"openChapterModal(chapter)\">\n\t\t\t\t\t\t\t{{ __('Edit Chapter') }}\n\t\t\t\t\t\t</Button>\n\t\t\t\t\t</div>\n\t\t\t\t</DisclosurePanel>\n\t\t\t</Disclosure>\n\t\t</div>\n\t</div>\n\t<ChapterModal\n\t\tv-model=\"showChapterModal\"\n\t\tv-model:outline=\"outline\"\n\t\t:course=\"courseName\"\n\t\t:chapterDetail=\"getCurrentChapter()\"\n\t/>\n</template>\n<script setup>\nimport { Button, createResource } from 'frappe-ui'\nimport { ref } from 'vue'\nimport { Disclosure, DisclosureButton, DisclosurePanel } from '@headlessui/vue'\nimport {\n\tChevronRight,\n\tMonitorPlay,\n\tHelpCircle,\n\tFileText,\n\tCheck,\n} from 'lucide-vue-next'\nimport { useRoute } from 'vue-router'\nimport ChapterModal from '@/components/Modals/ChapterModal.vue'\n\nconst route = useRoute()\nconst expandAll = ref(true)\nconst showChapterModal = ref(false)\nconst currentChapter = ref(null)\n\nconst props = defineProps({\n\tcourseName: {\n\t\ttype: String,\n\t\trequired: true,\n\t},\n\tshowOutline: {\n\t\ttype: Boolean,\n\t\tdefault: false,\n\t},\n\ttitle: {\n\t\ttype: String,\n\t\tdefault: '',\n\t},\n\tallowEdit: {\n\t\ttype: Boolean,\n\t\tdefault: false,\n\t},\n})\n\nconst outline = createResource({\n\turl: 'lms.lms.utils.get_course_outline',\n\tcache: ['course_outline', props.courseName],\n\tparams: {\n\t\tcourse: props.courseName,\n\t},\n\tauto: true,\n})\n\nconst openChapterDetail = (index) => {\n\treturn index == route.params.chapterNumber || index == 1\n}\n\nconst openChapterModal = (chapter = null) => {\n\tcurrentChapter.value = chapter\n\tshowChapterModal.value = true\n}\n\nconst getCurrentChapter = () => {\n\treturn currentChapter.value\n}\n</script>\n<style>\n.outline-lesson:has(.router-link-active) {\n\tbackground-color: theme('colors.gray.100');\n}\n</style>\n"],"names":["HelpCircle","createLucideIcon","MonitorPlay","show","_useModel","outline","__props","props","chapter","reactive","chapterResource","createResource","values","chapterEditResource","_a","chapterReference","addChapter","close","data","createToast","err","showError","editChapter","watch","newChapter","route","useRoute","ref","showChapterModal","currentChapter","openChapterDetail","index","openChapterModal","getCurrentChapter"],"mappings":"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","x_google_ignoreList":[0,1]}