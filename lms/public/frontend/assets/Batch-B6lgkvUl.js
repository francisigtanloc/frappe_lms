var he=Object.defineProperty;var ee=Object.getOwnPropertySymbols;var ve=Object.prototype.hasOwnProperty,ye=Object.prototype.propertyIsEnumerable;var te=(d,u,r)=>u in d?he(d,u,{enumerable:!0,configurable:!0,writable:!0,value:r}):d[u]=r,I=(d,u)=>{for(var r in u||(u={}))ve.call(u,r)&&te(d,r,u[r]);if(ee)for(var r of ee(u))ye.call(u,r)&&te(d,r,u[r]);return d};var H=(d,u,r)=>new Promise((m,i)=>{var g=l=>{try{p(r.next(l))}catch(h){i(h)}},t=l=>{try{p(r.throw(l))}catch(h){i(h)}},p=l=>l.done?m(l.value):Promise.resolve(l.value).then(g,t);p((r=r.apply(d,u)).next())});import{ad as N,d as M,ae as B,a as Z,k as S,w as se,x as o,G as x,H as k,B as a,C as b,N as n,A as e,ah as fe,ai as T,y,J as w,K as U,T as O,F as V,D as P,r as j,aa as L,I as A,b as q,O as J,aj as oe,ak as ne,W as G,al as re,am as ie,an as de,ao as ue,X as ae,a8 as ce,ap as me,aq as le,ar as ge,j as Y,$ as ke,a9 as xe,ab as $e,ac as Ve}from"./frappe-ui-CgFK8870.js";import{b as D,f as E,c as z,d as Ce,e as Se,t as we,B as Me}from"./index-GARLdoCV.js";import{a as _e,C as K,_ as Le}from"./DateRange-BwGlDrDQ.js";import{_ as F}from"./Link-IMATFM6Y.js";import{P as W}from"./plus-CsLQFB36.js";import{_ as De}from"./Discussions-Db8tgK1S.js";import{B as Ae}from"./book-open-check-heUzFGVr.js";import"./x-KQP2i48Y.js";import"./UserAvatar-CMVzFlfz.js";/**
 * @license lucide-vue-next v0.309.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Be=D("Contact2Icon",[["path",{d:"M16 18a4 4 0 0 0-8 0",key:"1lzouq"}],["circle",{cx:"12",cy:"11",r:"3",key:"itu57m"}],["rect",{width:"18",height:"18",x:"3",y:"4",rx:"2",key:"1hopcy"}],["line",{x1:"8",x2:"8",y1:"2",y2:"4",key:"1ff9gb"}],["line",{x1:"16",x2:"16",y1:"2",y2:"4",key:"1ufoma"}]]);/**
 * @license lucide-vue-next v0.309.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const je=D("LaptopIcon",[["path",{d:"M20 16V7a2 2 0 0 0-2-2H6a2 2 0 0 0-2 2v9m16 0H4m16 0 1.28 2.55a1 1 0 0 1-.9 1.45H3.62a1 1 0 0 1-.9-1.45L4 16",key:"tarvll"}]]);/**
 * @license lucide-vue-next v0.309.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Te=D("LayoutDashboardIcon",[["rect",{width:"7",height:"9",x:"3",y:"3",rx:"1",key:"10lvy0"}],["rect",{width:"7",height:"5",x:"14",y:"3",rx:"1",key:"16une8"}],["rect",{width:"7",height:"9",x:"14",y:"12",rx:"1",key:"1hutg5"}],["rect",{width:"7",height:"5",x:"3",y:"16",rx:"1",key:"ldoo1y"}]]);/**
 * @license lucide-vue-next v0.309.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Ue=D("MailIcon",[["rect",{width:"20",height:"16",x:"2",y:"4",rx:"2",key:"18n3k1"}],["path",{d:"m22 7-8.97 5.7a1.94 1.94 0 0 1-2.06 0L2 7",key:"1ocrg3"}]]);/**
 * @license lucide-vue-next v0.309.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Ee=D("MessageCircleIcon",[["path",{d:"M7.9 20A9 9 0 1 0 4 16.1L2 22Z",key:"vv11sd"}]]);/**
 * @license lucide-vue-next v0.309.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Ne=D("MonitorIcon",[["rect",{width:"20",height:"14",x:"2",y:"3",rx:"2",key:"48i651"}],["line",{x1:"8",x2:"16",y1:"21",y2:"21",key:"1svkeh"}],["line",{x1:"12",x2:"12",y1:"17",y2:"21",key:"vw1qmm"}]]);/**
 * @license lucide-vue-next v0.309.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Pe=D("SendIcon",[["path",{d:"m22 2-7 20-4-9-9-4Z",key:"1q3vgg"}],["path",{d:"M22 2 11 13",key:"nzbqef"}]]);/**
 * @license lucide-vue-next v0.309.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const pe=D("Trash2Icon",[["path",{d:"M3 6h18",key:"d0wm0j"}],["path",{d:"M19 6v14c0 1-1 2-2 2H7c-1 0-2-1-2-2V6",key:"4alrt4"}],["path",{d:"M8 6V4c0-1 1-2 2-2h4c1 0 2 1 2 2v2",key:"v07s0e"}],["line",{x1:"10",x2:"10",y1:"11",y2:"17",key:"1uufr5"}],["line",{x1:"14",x2:"14",y1:"11",y2:"17",key:"xtxkd"}]]);/**
 * @license lucide-vue-next v0.309.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const ze=D("UserRoundCogIcon",[["path",{d:"M2 21a8 8 0 0 1 10.434-7.62",key:"1yezr2"}],["circle",{cx:"10",cy:"8",r:"5",key:"o932ke"}],["circle",{cx:"18",cy:"18",r:"3",key:"1xkwt0"}],["path",{d:"m19.5 14.3-.4.9",key:"1eb35c"}],["path",{d:"m16.9 20.8-.4.9",key:"dfjc4z"}],["path",{d:"m21.7 19.5-.9-.4",key:"q4dx6b"}],["path",{d:"m15.2 16.9-.9-.4",key:"1r0w5f"}],["path",{d:"m21.7 16.5-.9.4",key:"1knoei"}],["path",{d:"m15.2 19.1-.9.4",key:"j188fs"}],["path",{d:"m19.5 21.7-.4-.9",key:"1tonu5"}],["path",{d:"m16.9 15.2-.4-.9",key:"699xu"}]]);/**
 * @license lucide-vue-next v0.309.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const qe=D("VideoIcon",[["path",{d:"m22 8-6 4 6 4V8Z",key:"50v9me"}],["rect",{width:"14",height:"12",x:"2",y:"6",rx:"2",ry:"2",key:"1rqjg6"}]]),Re={class:"flex flex-col gap-4"},Ie={class:"mb-1.5 text-sm text-gray-600"},He={class:"mb-1.5 text-sm text-gray-600"},Ye={key:0},Oe={class:"mb-1.5 text-sm text-gray-600"},Fe={class:"grid grid-cols-2 gap-2"},Ze=["onClick"],Je={key:1,class:"text-sm italic text-red-600"},Ge={__name:"EvaluationModal",props:N({courses:{type:Array,default:[]},batch:{type:String,default:null},endDate:{type:String,default:null}},{modelValue:{},modelModifiers:{},reloadEvals:{},reloadEvalsModifiers:{}}),emits:["update:modelValue","update:reloadEvals"],setup(d){const u=M("$user"),r=M("$dayjs"),m=B(d,"modelValue"),i=B(d,"reloadEvals"),g=d;let t=Z({course:"",date:"",start_time:"",end_time:"",day:"",batch:g.batch,member:u.data.name});const p=S({url:"frappe.client.insert",makeParams(s){return{doc:I({doctype:"LMS Certificate Request",batch_name:s.batch},s)}}});function l(s){p.submit(t,{validate(){if(!t.course)return"Please select a course.";if(!t.date)return"Please select a date.";if(!t.start_time)return"Please select a slot.";if(r(t.date).isSameOrBefore(r(),"day"))return"Please select a future date.";if(r(t.date).isAfter(r(g.endDate),"day"))return`Please select a date before the end date ${r(g.endDate).format("DD MMMM YYYY")}.`},onSuccess(){i.value.reload(),s()},onError(c){var f;z({title:"Error",text:((f=c.messages)==null?void 0:f[0])||c,icon:"x",iconClasses:"bg-red-600 text-white rounded-md p-px",position:"top-center",timeout:10})}})}const h=()=>{let s=[];for(const c of g.courses)s.push({label:c.title,value:c.course});return s},_=S({url:"lms.lms.doctype.course_evaluator.course_evaluator.get_schedule",makeParams(s){return{course:s.course,date:s.date,batch:g.batch}}});se(()=>t.date,s=>{t.start_time="",s&&t.course&&_.submit(t)}),se(()=>t.course,s=>{t.date="",t.start_time="",_.reset()});const v=s=>{t.start_time=s.start_time,t.end_time=s.end_time,t.day=s.day};return(s,c)=>(o(),x(e(P),{modelValue:m.value,"onUpdate:modelValue":c[2]||(c[2]=f=>m.value=f),options:{title:s.__("Schedule Evaluation"),size:"xl",actions:[{label:s.__("Submit"),variant:"solid",onClick:f=>l(f)}]}},{"body-content":k(()=>{var f;return[a("div",Re,[a("div",null,[a("div",Ie,b(s.__("Course")),1),n(e(fe),{modelValue:e(t).course,"onUpdate:modelValue":c[0]||(c[0]=C=>e(t).course=C),options:h()},null,8,["modelValue","options"])]),a("div",null,[a("div",He,b(s.__("Date")),1),n(e(T),{type:"date",modelValue:e(t).date,"onUpdate:modelValue":c[1]||(c[1]=C=>e(t).date=C)},null,8,["modelValue"])]),(f=e(_).data)!=null&&f.length?(o(),y("div",Ye,[a("div",Oe,b(s.__("Select a slot")),1),a("div",Fe,[(o(!0),y(w,null,U(e(_).data,C=>(o(),y("div",null,[a("div",{class:O(["text-base text-center border rounded-md bg-gray-200 p-2 cursor-pointer",{"border-gray-900":e(t).start_time==C.start_time}]),onClick:R=>v(C)},b(e(E)(C.start_time))+" - "+b(e(E)(C.end_time)),11,Ze)]))),256))])])):e(t).course&&e(t).date?(o(),y("div",Je,b(s.__("No slots available for this date.")),1)):V("",!0)])]}),_:1},8,["modelValue","options"]))}},Ke={class:"mb-10"},We={class:"text-lg font-semibold mb-4"},Xe={key:1},Qe={class:"grid grid-cols-2 gap-4"},et={class:"border rounded-md p-3"},tt={class:"font-semibold mb-3"},st={class:"flex items-center mb-2"},at={class:"ml-2"},lt={class:"flex items-center mb-2"},ot={class:"ml-2"},nt={class:"flex items-center"},rt={class:"ml-2 font-medium"},it={key:2,class:"text-sm italic text-gray-600"},dt={__name:"UpcomingEvaluations",props:{batch:{type:String,default:null},courses:{type:Array,default:[]},isStudent:{type:Boolean,default:!1},endDate:{type:String,default:null}},setup(d){const u=M("$dayjs"),r=M("$user"),m=j(!1),i=d,g=S({url:"lms.lms.utils.get_upcoming_evals",cache:["upcoming_evals",r.data.name],params:{student:r.data.name,courses:i.courses.map(p=>p.course)},auto:!0});function t(){m.value=!0}return(p,l)=>{var h;return o(),y(w,null,[a("div",Ke,[d.isStudent?(o(),x(e(A),{key:0,onClick:t,class:"float-right"},{default:k(()=>[L(b(p.__("Schedule Evaluation")),1)]),_:1})):V("",!0),a("div",We,b(p.__("Upcoming Evaluations")),1),(h=e(g).data)!=null&&h.length?(o(),y("div",Xe,[a("div",Qe,[(o(!0),y(w,null,U(e(g).data,_=>(o(),y("div",null,[a("div",et,[a("div",tt,b(_.course_title),1),a("div",st,[n(e(_e),{class:"w-4 h-4 stroke-1.5"}),a("span",at,b(e(u)(_.date).format("DD MMMM YYYY")),1)]),a("div",lt,[n(e(K),{class:"w-4 h-4 stroke-1.5"}),a("span",ot,b(e(E)(_.start_time)),1)]),a("div",nt,[n(e(ze),{class:"w-4 h-4 stroke-1.5"}),a("span",rt,b(_.evaluator_name),1)])])]))),256))])])):(o(),y("div",it,b(p.__("No upcoming evaluations.")),1))]),n(Ge,{batch:d.batch,endDate:d.endDate,courses:d.courses,modelValue:m.value,"onUpdate:modelValue":l[0]||(l[0]=_=>m.value=_),reloadEvals:e(g),"onUpdate:reloadEvals":l[1]||(l[1]=_=>q(g)?g.value=_:null)},null,8,["batch","endDate","courses","modelValue","reloadEvals"])],64)}}},ut={class:"text-lg font-semibold mb-4"},ct={key:0},mt={key:1,class:"text-sm italic text-gray-600"},be={__name:"Assessments",props:{batch:{type:String,required:!0},rows:{type:Array},columns:{type:Array},options:{type:Object,default:()=>({selectable:!0,totalCount:0,rowCount:0})}},setup(d){const u=M("$user"),m=S({url:"lms.lms.utils.get_assessments",params:{batch:d.batch},auto:!0}),i=()=>{var t;let g=[{label:"Assessment",key:"title"},{label:"Type",key:"assessment_type"}];return(t=u.data)!=null&&t.is_moderator||g.push({label:"Status/Score",key:"status",align:"center"}),g};return(g,t)=>{var p;return o(),y("div",null,[a("div",ut,b(g.__("Assessments")),1),(p=e(m).data)!=null&&p.length?(o(),y("div",ct,[n(e(J),{columns:i(),rows:e(m).data,"row-key":"name",options:{selectable:!1,showTooltip:!1,getRowRoute:l=>l.submission?{name:"AssignmentSubmission",params:{assignmentName:l.assessment_name,submissionName:l.submission.name}}:{name:"AssignmentSubmission",params:{assignmentName:l.assessment_name,submissionName:"new"}}}},null,8,["columns","rows","options"])])):(o(),y("div",mt,b(g.__("No Assessments")),1))])}}},_t={__name:"BatchDashboard",props:{batch:{type:Object,default:null},isStudent:{type:Boolean,default:!1}},setup(d){return(u,r)=>(o(),y("div",null,[n(dt,{batch:d.batch.data.name,endDate:d.batch.data.evaluation_end_date,courses:d.batch.data.courses,isStudent:d.isStudent},null,8,["batch","endDate","courses","isStudent"]),n(be,{batch:d.batch.data.name},null,8,["batch"])]))}},pt={__name:"BatchCourseModal",props:N({batch:{type:String,default:null}},{modelValue:{},modelModifiers:{},courses:{},coursesModifiers:{}}),emits:["update:modelValue","update:courses"],setup(d){const u=B(d,"modelValue"),r=j(null),m=j(null),i=B(d,"courses"),g=d,t=S({url:"frappe.client.insert",makeParams(l){return{doc:{doctype:"Batch Course",parent:g.batch,parenttype:"LMS Batch",parentfield:"courses",course:r.value,evaluator:m.value}}}}),p=l=>{t.submit({},{onSuccess(){i.value.reload(),l(),r.value=null,m.value=null},onError(h){Ce("Error",h.message[0]||h,"x")}})};return(l,h)=>(o(),x(e(P),{modelValue:u.value,"onUpdate:modelValue":h[2]||(h[2]=_=>u.value=_),options:{title:l.__("Add a course"),size:"sm",actions:[{label:l.__("Submit"),variant:"solid",onClick:_=>p(_)}]}},{"body-content":k(()=>[n(F,{doctype:"LMS Course",modelValue:r.value,"onUpdate:modelValue":h[0]||(h[0]=_=>r.value=_),label:l.__("Course")},null,8,["modelValue","label"]),n(F,{doctype:"Course Evaluator",modelValue:m.value,"onUpdate:modelValue":h[1]||(h[1]=_=>m.value=_),label:l.__("Evaluator"),class:"mt-4"},null,8,["modelValue","label"])]),_:1},8,["modelValue","options"]))}},bt={class:"flex items-center justify-between mb-4"},ht={class:"text-xl font-semibold"},vt={key:0},yt={class:"flex gap-2"},ft={__name:"BatchCourses",props:{batch:{type:String,required:!0}},setup(d){const u=j(!1),r=M("$user"),m=d,i=S({url:"lms.lms.utils.get_batch_courses",params:{batch:m.batch},cache:["batchCourses",m.batchName],auto:!0}),g=()=>{u.value=!0},t=()=>[{label:"Title",key:"title",width:2},{label:"Lessons",key:"lesson_count",align:"right"},{label:"Enrollments",align:"right",key:"enrollment_count"}],p=S({url:"frappe.client.delete",makeParams(h){return{doctype:"Batch Course",name:h.course}}}),l=(h,_)=>{h.forEach(v=>H(this,null,function*(){p.submit({course:v})})),setTimeout(()=>{i.reload(),_()},1e3)};return(h,_)=>{var v,s;return o(),y("div",null,[a("div",bt,[a("div",ht,b(h.__("Courses")),1),(v=e(r).data)!=null&&v.is_moderator?(o(),x(e(A),{key:0,variant:"solid",onClick:_[0]||(_[0]=c=>g())},{prefix:k(()=>[n(e(W),{class:"h-4 w-4"})]),default:k(()=>[L(" "+b(h.__("Add Course")),1)]),_:1})):V("",!0)]),(s=e(i).data)!=null&&s.length?(o(),y("div",vt,[n(e(J),{columns:t(),rows:e(i).data,"row-key":"batch_course",options:{showTooltip:!1}},{default:k(()=>[n(e(oe),{class:"mb-2 grid items-center space-x-4 rounded bg-gray-100 p-2"},{default:k(()=>[(o(!0),y(w,null,U(t(),c=>(o(),x(e(ne),{item:c},{prefix:k(({item:f})=>[f.icon?(o(),x(G(f.icon),{key:0,class:"h-4 w-4 stroke-1.5 ml-4"})):V("",!0)]),_:2},1032,["item"]))),256))]),_:1}),n(e(re),null,{default:k(()=>[(o(!0),y(w,null,U(e(i).data,c=>(o(),x(e(ie),{row:c},{default:k(({column:f,item:C})=>[n(e(de),{item:c[f.key],align:f.align},{default:k(()=>[a("div",null,b(c[f.key]),1)]),_:2},1032,["item","align"])]),_:2},1032,["row"]))),256))]),_:1}),n(e(ue),null,{actions:k(({unselectAll:c,selections:f})=>[a("div",yt,[n(e(A),{variant:"ghost",onClick:C=>l(f,c)},{default:k(()=>[n(e(pe),{class:"h-4 w-4 stroke-1.5"})]),_:2},1032,["onClick"])])]),_:1})]),_:1},8,["columns","rows"])])):V("",!0),n(pt,{modelValue:u.value,"onUpdate:modelValue":_[1]||(_[1]=c=>u.value=c),batch:d.batch,courses:e(i),"onUpdate:courses":_[2]||(_[2]=c=>q(i)?i.value=c:null)},null,8,["modelValue","batch","courses"])])}}},gt={class:"flex flex-col gap-4"},kt={class:"grid grid-cols-2 gap-4"},xt={__name:"LiveClassModal",props:N({batch:{type:String,default:null}},{reloadLiveClasses:{},reloadLiveClassesModifiers:{},modelValue:{},modelModifiers:{}}),emits:["update:reloadLiveClasses","update:modelValue"],setup(d){const u=B(d,"reloadLiveClasses"),r=B(d,"modelValue"),m=M("$user"),i=M("$dayjs");let t=Z({title:"",description:"",date:"",time:"",duration:"",timezone:"",auto_recording:"No Recording",batch:d.batch,host:m.data.name});const p=()=>Se().map(s=>({label:s,value:s})),l=()=>[{label:"No Recording",value:"No Recording"},{label:"Local",value:"Local"},{label:"Cloud",value:"Cloud"}],h=S({url:"lms.lms.doctype.lms_batch.lms_batch.create_live_class",makeParams(s){return I({doctype:"LMS Live Class",batch_name:s.batch},s)}}),_=s=>{h.submit(t,{validate(){if(!t.title)return"Please enter a title.";if(!t.date)return"Please select a date.";if(i(t.date).isSameOrBefore(i(),"day"))return"Please select a future date.";if(!t.time)return"Please select a time.";if(!v())return"Please enter a valid time in the format HH:mm.";if(!t.duration)return"Please select a duration.";if(!t.timezone)return"Please select a timezone."},onSuccess(){u.value.reload(),s()},onError(c){var f;z({title:"Error",text:((f=c.messages)==null?void 0:f[0])||c,icon:"x",iconClasses:"bg-red-600 text-white rounded-md p-px",position:"top-center",timeout:10})}})},v=()=>{let s=t.time.split(":");return!(s.length!=2||s[0]<0||s[0]>23||s[1]<0||s[1]>59)};return(s,c)=>(o(),x(e(P),{modelValue:r.value,"onUpdate:modelValue":c[7]||(c[7]=f=>r.value=f),options:{title:s.__("Create a Live Class"),size:"xl",actions:[{label:"Submit",variant:"solid",onClick:f=>_(f)}]}},{"body-content":k(()=>[a("div",gt,[a("div",kt,[a("div",null,[n(e(T),{type:"text",modelValue:e(t).title,"onUpdate:modelValue":c[0]||(c[0]=f=>e(t).title=f),label:s.__("Title"),class:"mb-4"},null,8,["modelValue","label"]),n(e(ae),{text:s.__("Time must be in 24 hour format (HH:mm). Example 11:30 or 22:00")},{default:k(()=>[n(e(T),{modelValue:e(t).time,"onUpdate:modelValue":c[1]||(c[1]=f=>e(t).time=f),type:"time",label:s.__("Time"),class:"mb-4"},null,8,["modelValue","label"])]),_:1},8,["text"]),n(e(T),{modelValue:e(t).timezone,"onUpdate:modelValue":c[2]||(c[2]=f=>e(t).timezone=f),type:"select",options:p(),label:s.__("Timezone")},null,8,["modelValue","options","label"])]),a("div",null,[n(e(T),{modelValue:e(t).date,"onUpdate:modelValue":c[3]||(c[3]=f=>e(t).date=f),type:"date",class:"mb-4",label:s.__("Date")},null,8,["modelValue","label"]),n(e(ae),{text:s.__("Duration of the live class in minutes")},{default:k(()=>[n(e(T),{type:"number",modelValue:e(t).duration,"onUpdate:modelValue":c[4]||(c[4]=f=>e(t).duration=f),label:s.__("Duration"),class:"mb-4"},null,8,["modelValue","label"])]),_:1},8,["text"]),n(e(T),{modelValue:e(t).auto_recording,"onUpdate:modelValue":c[5]||(c[5]=f=>e(t).auto_recording=f),type:"select",options:l(),label:s.__("Auto Recording")},null,8,["modelValue","options","label"])])]),n(e(T),{modelValue:e(t).description,"onUpdate:modelValue":c[6]||(c[6]=f=>e(t).description=f),type:"textarea",label:s.__("Description")},null,8,["modelValue","label"])])]),_:1},8,["modelValue","options"]))}},$t={class:"text-lg font-semibold mb-4"},Vt={key:1,class:"grid grid-cols-2 gap-5"},Ct={class:"border rounded-md p-3"},St={class:"font-semibold text-lg mb-4"},wt={class:"flex items-center mb-2"},Mt={class:"ml-2"},Lt={class:"flex items-center mb-5"},Dt={class:"ml-2"},At={class:"mb-5"},Bt={class:"flex items-center gap-2"},jt=["href"],Tt=["href"],Ut={key:2,class:"text-sm italic text-gray-600"},Et={__name:"LiveClass",props:{batch:{type:String,required:!0}},setup(d){const u=M("$user"),r=j(!1),m=M("$dayjs"),i=d,g=ce({doctype:"LMS Live Class",filters:{batch_name:i.batch,date:[">=",new Date]},fields:["title","description","time","date","start_url","join_url","owner"],orderBy:"date",auto:!0}),t=()=>{r.value=!0};return(p,l)=>{var h;return o(),y(w,null,[e(u).data.is_moderator?(o(),x(e(A),{key:0,variant:"solid",class:"float-right mb-3",onClick:t},{prefix:k(()=>[n(e(W),{class:"h-4 w-4"})]),default:k(()=>[a("span",null,b(p.__("Add Live Class")),1)]),_:1})):V("",!0),a("div",$t,b(p.__("Live Class")),1),(h=e(g).data)!=null&&h.length?(o(),y("div",Vt,[(o(!0),y(w,null,U(e(g).data,_=>(o(),y("div",null,[a("div",Ct,[a("div",St,b(_.title),1),a("div",wt,[n(e(_e),{class:"w-4 h-4 stroke-1.5"}),a("span",Mt,b(e(m)(_.date).format("DD MMMM YYYY")),1)]),a("div",Lt,[n(e(K),{class:"w-4 h-4 stroke-1.5"}),a("span",Dt,b(e(E)(_.time)),1)]),a("div",At,b(_.description),1),a("div",Bt,[a("a",{href:_.start_url,target:"_blank",class:"w-1/2 cursor-pointer inline-flex items-center justify-center gap-2 transition-colors focus:outline-none text-gray-800 bg-gray-100 hover:bg-gray-200 active:bg-gray-300 focus-visible:ring focus-visible:ring-gray-400 h-7 text-base px-2 rounded"},[n(e(Ne),{class:"h-4 w-4 stroke-1.5"}),L(" "+b(p.__("Start")),1)],8,jt),a("a",{href:_.join_url,target:"_blank",class:"w-1/2 cursor-pointer inline-flex items-center justify-center gap-2 transition-colors focus:outline-none text-gray-800 bg-gray-100 hover:bg-gray-200 active:bg-gray-300 focus-visible:ring focus-visible:ring-gray-400 h-7 text-base px-2 rounded"},[n(e(qe),{class:"h-4 w-4 stroke-1.5"}),L(" "+b(p.__("Join")),1)],8,Tt)])])]))),256))])):(o(),y("div",Ut,b(p.__("No live classes scheduled")),1)),n(xt,{batch:i.batch,modelValue:r.value,"onUpdate:modelValue":l[0]||(l[0]=_=>r.value=_),reloadLiveClasses:e(g),"onUpdate:reloadLiveClasses":l[1]||(l[1]=_=>q(g)?g.value=_:null)},null,8,["batch","modelValue","reloadLiveClasses"])],64)}}},Nt={class:"flex flex-col gap-4"},Pt={__name:"StudentModal",props:N({batch:{type:String,default:null}},{reloadStudents:{},reloadStudentsModifiers:{},modelValue:{},modelModifiers:{}}),emits:["update:reloadStudents","update:modelValue"],setup(d){const u=B(d,"reloadStudents"),r=j(),m=B(d,"modelValue"),i=d,g=S({url:"frappe.client.insert",makeParams(p){return{doc:{doctype:"Batch Student",parent:i.batch,parenttype:"LMS Batch",parentfield:"students",student:r.value}}}}),t=p=>{g.submit({},{onSuccess(){u.value.reload(),p(),r.value=null}})};return(p,l)=>(o(),x(e(P),{modelValue:m.value,"onUpdate:modelValue":l[1]||(l[1]=h=>m.value=h),options:{title:p.__("Add a Student"),size:"sm",actions:[{label:"Submit",variant:"solid",onClick:h=>t(h)}]}},{"body-content":k(()=>[a("div",Nt,[n(F,{doctype:"User",modelValue:r.value,"onUpdate:modelValue":l[0]||(l[0]=h=>r.value=h),filters:{ignore_user_type:1}},null,8,["modelValue"])])]),_:1},8,["modelValue","options"]))}},zt={class:"text-lg font-semibold mb-4"},qt={key:0},Rt={key:0},It={class:"flex gap-2"},Ht={key:1,class:"text-sm italic text-gray-600"},Yt={__name:"BatchStudents",props:{batch:{type:String,default:null}},setup(d){const u=j(!1),r=d,m=S({url:"lms.lms.utils.get_batch_students",cache:["students",r.batch],params:{batch:r.batch},auto:!0}),i=()=>[{label:"Full Name",key:"full_name",width:2},{label:"Courses Done",key:"courses_completed",align:"center"},{label:"Assessments Done",key:"assessments_completed",align:"center"},{label:"Last Active",key:"last_active"}],g=()=>{u.value=!0},t=S({url:"frappe.client.delete",makeParams(l){return{doctype:"Batch Student",name:l.student}}}),p=(l,h)=>{l.forEach(_=>H(this,null,function*(){t.submit({student:_})})),setTimeout(()=>{m.reload(),h()},500)};return(l,h)=>{var _;return o(),y(w,null,[n(e(A),{class:"float-right mb-3",variant:"solid",onClick:h[0]||(h[0]=v=>g())},{prefix:k(()=>[n(e(W),{class:"h-4 w-4"})]),default:k(()=>[L(" "+b(l.__("Add Student")),1)]),_:1}),a("div",zt,b(l.__("Students")),1),(_=e(m).data)!=null&&_.length?(o(),y("div",qt,[n(e(J),{columns:i(),rows:e(m).data,"row-key":"name",options:{showTooltip:!1}},{default:k(()=>[n(e(oe),{class:"mb-2 grid items-center space-x-4 rounded bg-gray-100 p-2"},{default:k(()=>[(o(!0),y(w,null,U(i(),v=>(o(),x(e(ne),{item:v},{prefix:k(({item:s})=>[s.icon?(o(),x(G(s.icon),{key:0,class:"h-4 w-4 stroke-1.5 ml-4"})):V("",!0)]),_:2},1032,["item"]))),256))]),_:1}),n(e(re),null,{default:k(()=>[(o(!0),y(w,null,U(e(m).data,v=>(o(),x(e(ie),{row:v},{default:k(({column:s,item:c})=>[n(e(de),{item:v[s.key],align:s.align},{prefix:k(()=>[s.key=="full_name"?(o(),y("div",Rt,[n(e(me),{class:"flex items-center",image:v.user_image,label:c,size:"sm"},null,8,["image","label"])])):V("",!0)]),default:k(()=>[a("div",null,b(v[s.key]),1)]),_:2},1032,["item","align"])]),_:2},1032,["row"]))),256))]),_:1}),n(e(ue),null,{actions:k(({unselectAll:v,selections:s})=>[a("div",It,[n(e(A),{variant:"ghost",onClick:c=>p(s,v)},{default:k(()=>[n(e(pe),{class:"h-4 w-4 stroke-1.5"})]),_:2},1032,["onClick"])])]),_:1})]),_:1},8,["columns","rows"])])):(o(),y("div",Ht,b(l.__("There are no students in this batch.")),1)),n(Pt,{batch:r.batch,modelValue:u.value,"onUpdate:modelValue":h[1]||(h[1]=v=>u.value=v),reloadStudents:e(m),"onUpdate:reloadStudents":h[2]||(h[2]=v=>q(m)?m.value=v:null)},null,8,["batch","modelValue","reloadStudents"])],64)}}},Ot={key:0},Ft={class:"mb-8"},Zt={class:"flex items-center justify-between mb-2"},Jt={class:"flex items-center"},Gt={class:"ml-2"},Kt={class:"text-sm"},Wt=["innerHTML"],Xt={key:1,class:"text-sm italic text-gray-600"},Qt={__name:"Annoucements",props:{batch:{type:String,required:!0}},setup(d){const u=d,r=ce({doctype:"Communication",fields:["subject","content","recipients","cc","communication_date","sender","sender_full_name"],filters:{reference_doctype:"LMS Batch",reference_name:u.batch},orderBy:"communication_date desc",auto:!0,cache:["batch",u.batch]});return(m,i)=>{var g;return(g=e(r).data)!=null&&g.length?(o(),y("div",Ot,[(o(!0),y(w,null,U(e(r).data,t=>(o(),y("div",null,[a("div",Ft,[a("div",Zt,[a("div",Jt,[n(e(me),{label:t.sender_full_name,size:"lg"},null,8,["label"]),a("div",Gt,b(t.sender_full_name),1)]),a("div",Kt,b(e(we)(t.communication_date)),1)]),a("div",{class:"prose prose-sm bg-gray-50 !min-w-full px-4 py-2 rounded-md",innerHTML:t.content},null,8,Wt)])]))),256))])):(o(),y("div",Xt,b(m.__("No announcements")),1))}}},es={class:"flex flex-col gap-4"},ts={class:""},ss={class:"mb-1.5 text-sm text-gray-600"},as={class:""},ls={class:"mb-1.5 text-sm text-gray-600"},os={class:"mb-4"},ns={class:"mb-1.5 text-sm text-gray-600"},rs={__name:"AnnouncementModal",props:N({batch:{type:String,required:!0},students:{type:Array,required:!0}},{modelValue:{},modelModifiers:{}}),emits:["update:modelValue"],setup(d){const u=B(d,"modelValue"),r=d,m=Z({subject:"",replyTo:"",announcement:""}),i=S({url:"frappe.core.doctype.communication.email.make",makeParams(t){return{recipients:r.students.join(", "),cc:m.replyTo,subject:m.subject,content:m.announcement,doctype:"LMS Batch",name:r.batch,send_email:1}}}),g=t=>{i.submit({},{validate(){if(!r.students.length)return"No students in this batch";if(!m.subject)return"Subject is required"},onSuccess(){t(),z({title:"Success",text:"Announcement has been sent successfully",icon:"Check",iconClasses:"bg-green-600 text-white rounded-md p-px"})},onError(p){var l;z({title:"Error",text:((l=p.messages)==null?void 0:l[0])||p,icon:"x",iconClasses:"bg-red-600 text-white rounded-md p-px",position:"top-center",timeout:10})}})};return(t,p)=>(o(),x(e(P),{modelValue:u.value,"onUpdate:modelValue":p[3]||(p[3]=l=>u.value=l),options:{title:t.__("Make an Announcement"),size:"xl",actions:[{label:"Submit",variant:"solid",onClick:l=>g(l)}]}},{"body-content":k(()=>[a("div",es,[a("div",ts,[a("div",ss,b(t.__("Subject")),1),n(e(le),{type:"text",modelValue:m.subject,"onUpdate:modelValue":p[0]||(p[0]=l=>m.subject=l)},null,8,["modelValue"])]),a("div",as,[a("div",ls,b(t.__("Reply To")),1),n(e(le),{type:"text",modelValue:m.replyTo,"onUpdate:modelValue":p[1]||(p[1]=l=>m.replyTo=l)},null,8,["modelValue"])]),a("div",os,[a("div",ns,b(t.__("Announcement")),1),n(e(ge),{bubbleMenu:!0,onChange:p[2]||(p[2]=l=>m.announcement=l),editorClass:"prose-sm py-2 px-2 min-h-[200px] border-gray-300 hover:border-gray-400 rounded-md bg-gray-200"})])])]),_:1},8,["modelValue","options"]))}},is={key:0,class:""},ds={class:"sticky top-0 z-10 flex items-center justify-between border-b bg-white px-3 py-2.5 sm:px-5"},us={key:0,class:"grid grid-cols-[70%,30%] h-screen"},cs={class:"border-r-2"},ms={class:"pt-5 px-10 pb-10"},_s={key:0},ps={key:1},bs={key:2},hs={key:3},vs={key:4},ys={key:5},fs={key:6},gs={class:"p-5"},ks={class:"text-2xl font-semibold mb-2"},xs=["innerHTML"],$s={class:"flex items-center mb-6"},Vs={key:1,class:""},Cs={class:"text-base border rounded-md w-1/3 mx-auto my-32"},Ss={class:"border-b px-5 py-3 font-medium"},ws=a("span",{class:"inline-flex items-center before:bg-red-600 before:w-2 before:h-2 before:rounded-md before:mr-2"},null,-1),Ms={class:"px-5 py-3"},Ls={key:0,class:"mb-4 leading-6"},Ds={key:1,class:"mb-4 leading-6"},Rs={__name:"Batch",props:{batchName:{type:String,required:!0}},setup(d){const u=M("$user"),r=j(!1),m=d,i=S({url:"lms.lms.utils.get_batch_details",cache:["batch",m.batchName],params:{batch:m.batchName},auto:!0}),g=Y(()=>{var s,c;let v=[{label:"All Batches",route:{name:"Batches"}}];return t.value||v.push({label:"Details",route:{name:"BatchDetail",params:{batchName:(s=i.data)==null?void 0:s.name}}}),v.push({label:(c=i==null?void 0:i.data)==null?void 0:c.title,route:{name:"Batch",params:{batchName:m.batchName}}}),v}),t=Y(()=>{var v,s;return(u==null?void 0:u.data)&&((v=i.data)==null?void 0:v.students.length)&&((s=i.data)==null?void 0:s.students.includes(u.data.name))}),p=j(0),l=Y(()=>{var s;let v=[];return t.value&&v.push({label:"Dashboard",icon:Te}),(s=u.data)!=null&&s.is_moderator&&(v.push({label:"Students",icon:Be}),v.push({label:"Assessments",icon:Ae})),v.push({label:"Live Class",icon:je}),v.push({label:"Courses",icon:Me}),v.push({label:"Announcements",icon:Ue}),v.push({label:"Discussions",icon:Ee}),v}),h=()=>{window.location.href="/login?redirect-to=/batches"},_=()=>{r.value=!0};return(v,s)=>{var f,C,R,X;const c=ke("router-link");return(f=e(u).data)!=null&&f.is_moderator||t.value?(o(),y("div",is,[a("header",ds,[n(e(xe),{class:"h-7",items:g.value},null,8,["items"]),(C=e(u).data)!=null&&C.is_moderator?(o(),x(e(A),{key:0,onClick:s[0]||(s[0]=$=>_())},{suffix:k(()=>[n(e(Pe),{class:"h-4 stroke-1.5"})]),default:k(()=>[a("span",null,b(v.__("Make an Announcement")),1)]),_:1})):V("",!0)]),e(i).data?(o(),y("div",us,[a("div",cs,[n(e(Ve),{modelValue:p.value,"onUpdate:modelValue":s[1]||(s[1]=$=>p.value=$),tabs:l.value,tablistClass:"overflow-x-visible"},{tab:k(({tab:$,selected:Q})=>[a("div",null,[a("button",{class:O(["group -mb-px flex items-center gap-1 border-b border-transparent py-2.5 text-base text-gray-600 duration-300 ease-in-out hover:border-gray-400 hover:text-gray-900",{"text-gray-900":Q}])},[$.icon?(o(),x(G($.icon),{key:0,class:"h-4 stroke-1.5"})):V("",!0),L(" "+b(v.__($.label))+" ",1),$.count?(o(),x(e($e),{key:1,class:O({"text-gray-900 border border-gray-900":Q}),variant:"subtle",theme:"gray",size:"sm"},{default:k(()=>[L(b($.count),1)]),_:2},1032,["class"])):V("",!0)],2)])]),default:k(({tab:$})=>[a("div",ms,[$.label=="Courses"?(o(),y("div",_s,[n(ft,{batch:e(i).data.name},null,8,["batch"])])):$.label=="Dashboard"?(o(),y("div",ps,[n(_t,{batch:e(i),isStudent:t.value},null,8,["batch","isStudent"])])):$.label=="Live Class"?(o(),y("div",bs,[n(Et,{batch:e(i).data.name},null,8,["batch"])])):$.label=="Students"?(o(),y("div",hs,[n(Yt,{batch:e(i).data.name},null,8,["batch"])])):$.label=="Assessments"?(o(),y("div",vs,[n(be,{batch:e(i).data.name},null,8,["batch"])])):$.label=="Announcements"?(o(),y("div",ys,[n(Qt,{batch:e(i).data.name},null,8,["batch"])])):$.label=="Discussions"?(o(),y("div",fs,[(o(),x(De,{doctype:"LMS Batch",docname:e(i).data.name,title:"Discussions",key:e(i).data.name,singleThread:!0},null,8,["docname"]))])):V("",!0)])]),_:1},8,["modelValue","tabs"])]),a("div",gs,[a("div",ks,b(e(i).data.title),1),a("div",{innerHTML:e(i).data.description,class:"leading-5 mb-4"},null,8,xs),n(Le,{startDate:e(i).data.start_date,endDate:e(i).data.end_date,class:"mb-3"},null,8,["startDate","endDate"]),a("div",$s,[n(e(K),{class:"h-4 w-4 stroke-1.5 mr-2 text-gray-700"}),a("span",null,b(e(E)(e(i).data.start_time))+" - "+b(e(E)(e(i).data.end_time)),1)])]),n(rs,{modelValue:r.value,"onUpdate:modelValue":s[2]||(s[2]=$=>r.value=$),batch:e(i).data.name,students:e(i).data.students},null,8,["modelValue","batch","students"])])):V("",!0)])):(R=e(u).data)!=null&&R.name?V("",!0):(o(),y("div",Vs,[a("div",Cs,[a("div",Ss,[ws,L(" "+b(v.__("Not Permitted")),1)]),a("div",Ms,[e(u).data?(o(),y("div",Ls,b(v.__("You are not a member of this batch. Please checkout our upcoming batches.")),1)):(o(),y("div",Ds,b(v.__("Please login to access this page.")),1)),e(u).data?(o(),x(c,{key:2,to:{name:"Batches",params:{batchName:(X=e(i).data)==null?void 0:X.name}}},{default:k(()=>[n(e(A),{variant:"solid",class:"w-full"},{default:k(()=>[L(b(v.__("Upcoming Batches")),1)]),_:1})]),_:1},8,["to"])):(o(),x(e(A),{key:3,variant:"solid",class:"w-full",onClick:s[3]||(s[3]=$=>h())},{default:k(()=>[L(b(v.__("Login")),1)]),_:1}))])])]))}}};export{Rs as default};
//# sourceMappingURL=Batch-B6lgkvUl.js.map
