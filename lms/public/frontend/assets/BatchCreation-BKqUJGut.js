var F=Object.defineProperty;var V=Object.getOwnPropertySymbols;var L=Object.prototype.hasOwnProperty,I=Object.prototype.propertyIsEnumerable;var v=(r,i,d)=>i in r?F(r,i,{enumerable:!0,configurable:!0,writable:!0,value:d}):r[i]=d,g=(r,i)=>{for(var d in i||(i={}))L.call(i,d)&&v(r,d,i[d]);if(V)for(var d of V(i))I.call(i,d)&&v(r,d,i[d]);return r};import{a as z,s as R,k as _,j as A,x as f,y as B,B as s,N as o,A as n,H as h,C as u,G as q,d as G,a9 as H,aa as k,I as w,ai as m,aw as X,ar as J,S as K}from"./frappe-ui-CgFK8870.js";import{_ as S}from"./Link-IMATFM6Y.js";import{d as N,i as Q}from"./index-GARLdoCV.js";import{F as W}from"./file-text-DHp4eWlu.js";import{X as Y}from"./x-KQP2i48Y.js";import"./plus-CsLQFB36.js";const Z={class:""},ee={class:"sticky top-0 z-10 flex items-center justify-between border-b bg-white px-3 py-2.5 sm:px-5"},ae={class:"py-5"},le={class:"container"},te={class:"text-lg font-semibold mb-4"},se={class:"grid grid-cols-2 gap-10"},oe={class:"mb-4"},ne={key:1,class:"mt-4"},ie={class:"text-xs text-gray-600 mb-1"},de={class:"flex items-center"},me={class:"border rounded-md p-2 mr-2"},re={class:"flex flex-col"},ue={class:"text-sm text-gray-500 mt-1"},be={class:"container border-b mb-5"},ce={class:"block text-sm text-gray-600 mb-1"},pe={class:"container border-b mb-5"},_e={class:"text-lg font-semibold mb-4"},ge={class:"grid grid-cols-2 gap-10"},fe={class:"container"},he={class:"text-lg font-semibold mb-4"},Ne={__name:"BatchCreation",props:{batchName:{type:String,required:!0}},setup(r){const i=K(),d=G("$user"),b=r,l=z({title:"",published:!1,description:"",batch_details:"",start_date:"",end_date:"",start_time:"",end_time:"",evaluation_end_date:"",seat_count:"",medium:"",category:"",image:null,paid_batch:!1,currency:"",amount:0});R(()=>{d.data||(window.location.href="/login"),b.batchName!="new"&&c.reload()});const U=_({url:"frappe.client.insert",makeParams(a){var e;return{doc:g({doctype:"LMS Batch",meta_image:(e=l.image)==null?void 0:e.file_url},l)}}}),c=_({url:"frappe.client.get",makeParams(a){return{doctype:"LMS Batch",name:b.batchName}},onSuccess(a){Object.keys(a).forEach(t=>{Object.hasOwn(l,t)&&(l[t]=a[t])});let e=["published","paid_batch"];for(let t in e){let p=e[t];l[p]=!!l[p]}a.meta_image&&C.reload({image:a.meta_image})}}),x=_({url:"frappe.client.set_value",makeParams(a){var e;return{doctype:"LMS Batch",name:b.batchName,fieldname:g({meta_image:(e=l.image)==null?void 0:e.file_url},l)}}}),C=_({url:"lms.lms.api.get_file_info",makeParams(a){return{file_url:a.image}},auto:!1,onSuccess(a){l.image=a}}),D=()=>{c.data?M():E()},E=()=>{U.submit({},{onSuccess(a){i.push({name:"BatchDetail",params:{batchName:a.name}})},onError(a){var e;N("Error",((e=a.messages)==null?void 0:e[0])||a,"x")}})},M=()=>{x.submit({},{onSuccess(a){i.push({name:"BatchDetail",params:{batchName:a.name}})},onError(a){var e;N("Error",((e=a.messages)==null?void 0:e[0])||a,"x")}})},O=a=>{l.image=a},T=()=>{l.image=null},$=a=>{let e=a.name.split(".").pop().toLowerCase();if(!["jpg","jpeg","png"].includes(e))return"Only image file is allowed."},j=A(()=>{let a=[{label:"Batches",route:{name:"Batches"}}];return c.data&&a.push({label:c.data.title,route:{name:"BatchDetail",params:{batchName:b.batchName}}}),a.push({label:b.batchName=="new"?"New Batch":"Edit Batch",route:{name:"BatchCreation",params:{batchName:b.batchName}}}),a});return(a,e)=>(f(),B("div",Z,[s("header",ee,[o(n(H),{class:"h-7",items:j.value},null,8,["items"]),o(n(w),{variant:"solid",onClick:e[0]||(e[0]=t=>D())},{default:h(()=>[k(u(a.__("Save")),1)]),_:1})]),s("div",ae,[s("div",le,[s("div",te,u(a.__("Details")),1),s("div",se,[s("div",null,[o(n(m),{modelValue:l.title,"onUpdate:modelValue":e[1]||(e[1]=t=>l.title=t),label:a.__("Title"),class:"mb-4"},null,8,["modelValue","label"]),o(n(m),{modelValue:l.description,"onUpdate:modelValue":e[2]||(e[2]=t=>l.description=t),label:a.__("Description"),type:"textarea",class:"mb-4"},null,8,["modelValue","label"])]),s("div",null,[o(n(m),{modelValue:l.published,"onUpdate:modelValue":e[3]||(e[3]=t=>l.published=t),type:"checkbox",label:a.__("Published")},null,8,["modelValue","label"]),l.image?(f(),B("div",ne,[s("div",ie,u(a.__("Meta Image")),1),s("div",de,[s("div",me,[o(n(W),{class:"h-5 w-5 stroke-1.5 text-gray-700"})]),s("div",re,[s("span",null,u(l.image.file_name),1),s("span",ue,u(n(Q)(l.image.file_size)),1)]),o(n(Y),{onClick:e[5]||(e[5]=t=>T()),class:"bg-gray-200 rounded-md cursor-pointer stroke-1.5 w-5 h-5 p-1 ml-4"})])])):(f(),q(n(X),{key:0,class:"mt-4",fileTypes:["image/*"],validateFile:$,onSuccess:e[4]||(e[4]=t=>O(t))},{default:h(({file:t,progress:p,uploading:y,openFileSelector:P})=>[s("div",oe,[o(n(w),{onClick:P,loading:y},{default:h(()=>[k(u(y?`Uploading ${p}%`:"Upload an image"),1)]),_:2},1032,["onClick","loading"])])]),_:1}))])])]),s("div",be,[s("div",null,[s("label",ce,u(a.__("Batch Details")),1),o(n(J),{content:l.batch_details,onChange:e[6]||(e[6]=t=>l.batch_details=t),editable:!0,fixedMenu:!0,editorClass:"prose-sm max-w-none border-b border-x bg-gray-100 rounded-b-md py-1 px-2 min-h-[7rem] mb-4"},null,8,["content"])])]),s("div",pe,[s("div",_e,u(a.__("Settings")),1),s("div",ge,[s("div",null,[o(n(m),{modelValue:l.start_date,"onUpdate:modelValue":e[7]||(e[7]=t=>l.start_date=t),label:a.__("Start Date"),type:"date",class:"mb-4"},null,8,["modelValue","label"]),o(n(m),{modelValue:l.end_date,"onUpdate:modelValue":e[8]||(e[8]=t=>l.end_date=t),label:a.__("End Date"),type:"date",class:"mb-4"},null,8,["modelValue","label"]),o(n(m),{modelValue:l.start_time,"onUpdate:modelValue":e[9]||(e[9]=t=>l.start_time=t),label:a.__("Start Time"),type:"time",class:"mb-4"},null,8,["modelValue","label"]),o(n(m),{modelValue:l.end_time,"onUpdate:modelValue":e[10]||(e[10]=t=>l.end_time=t),label:a.__("End Time"),type:"time",class:"mb-4"},null,8,["modelValue","label"])]),s("div",null,[o(n(m),{modelValue:l.seat_count,"onUpdate:modelValue":e[11]||(e[11]=t=>l.seat_count=t),label:a.__("Seat Count"),type:"number",class:"mb-4"},null,8,["modelValue","label"]),o(n(m),{modelValue:l.evaluation_end_date,"onUpdate:modelValue":e[12]||(e[12]=t=>l.evaluation_end_date=t),label:a.__("Evaluation End Date"),type:"date",class:"mb-4"},null,8,["modelValue","label"]),o(n(m),{modelValue:l.medium,"onUpdate:modelValue":e[13]||(e[13]=t=>l.medium=t),type:"select",options:[{label:"Online",value:"Online"},{label:"Offline",value:"Offline"}],label:a.__("Medium"),class:"mb-4"},null,8,["modelValue","label"]),o(S,{doctype:"LMS Category",label:a.__("Category"),modelValue:l.category,"onUpdate:modelValue":e[14]||(e[14]=t=>l.category=t)},null,8,["label","modelValue"])])])]),s("div",fe,[s("div",he,u(a.__("Payment")),1),s("div",null,[o(n(m),{modelValue:l.paid_batch,"onUpdate:modelValue":e[15]||(e[15]=t=>l.paid_batch=t),type:"checkbox",label:a.__("Paid Batch")},null,8,["modelValue","label"]),o(n(m),{modelValue:l.amount,"onUpdate:modelValue":e[16]||(e[16]=t=>l.amount=t),label:a.__("Amount"),type:"number",class:"my-4"},null,8,["modelValue","label"]),o(S,{doctype:"Currency",modelValue:l.currency,"onUpdate:modelValue":e[17]||(e[17]=t=>l.currency=t),filters:{enabled:1},label:a.__("Currency")},null,8,["modelValue","label"])])])])]))}};export{Ne as default};
//# sourceMappingURL=BatchCreation-BKqUJGut.js.map
