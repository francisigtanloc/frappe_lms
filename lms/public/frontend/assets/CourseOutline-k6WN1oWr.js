import{ad as q,ae as B,a as A,k as N,w as F,x as s,G as f,H as d,N as m,A as l,ai as P,D as z,r as E,$ as H,y as C,B as k,C as g,aa as w,I as M,F as v,T as L,J as D,K as T,aF as I,aG as U,aH as j,b as G,ag as J}from"./frappe-ui-CgFK8870.js";import{b as O,c as R}from"./index-GARLdoCV.js";import{C as K}from"./chevron-right-jcxn7em3.js";import{F as Q}from"./file-text-DHp4eWlu.js";import{C as Z}from"./check-t5WR0f1n.js";/**
 * @license lucide-vue-next v0.309.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const W=O("HelpCircleIcon",[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["path",{d:"M9.09 9a3 3 0 0 1 5.83 1c0 2-3 3-3 3",key:"1u773s"}],["path",{d:"M12 17h.01",key:"p32p05"}]]);/**
 * @license lucide-vue-next v0.309.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const X=O("MonitorPlayIcon",[["path",{d:"m10 7 5 3-5 3Z",key:"29ljg6"}],["rect",{width:"20",height:"14",x:"2",y:"3",rx:"2",key:"48i651"}],["path",{d:"M12 17v4",key:"1riwvh"}],["path",{d:"M8 21h8",key:"1ev6f3"}]]),Y={__name:"ChapterModal",props:q({course:{type:String,required:!0},chapterDetail:{type:Object}},{modelValue:{},modelModifiers:{},outline:{},outlineModifiers:{}}),emits:["update:modelValue","update:outline"],setup(a){const x=B(a,"modelValue"),y=B(a,"outline"),h=a,n=A({title:""}),p=N({url:"frappe.client.insert",makeParams(e){return{doc:{doctype:"Course Chapter",title:n.title,description:n.description,course:h.course}}}}),_=N({url:"frappe.client.set_value",makeParams(e){var t;return{doctype:"Course Chapter",name:(t=h.chapterDetail)==null?void 0:t.name,fieldname:"title",value:n.title}}}),b=N({url:"frappe.client.insert",makeParams(e){return{doc:{doctype:"Chapter Reference",chapter:e.name,parent:h.course,parenttype:"LMS Course",parentfield:"chapters"}}}}),V=e=>{p.submit({},{validate(){if(!n.title)return"Title is required"},onSuccess:t=>{b.submit({name:t.name},{onSuccess(r){y.value.reload(),R({text:"Chapter added successfully",icon:"check",iconClasses:"bg-green-600 text-white rounded-md p-px"})},onError(r){u(r)}}),e()},onError(t){u(t)}})},i=e=>{_.submit({},{validate(){if(!n.title)return"Title is required"},onSuccess(){y.value.reload(),R({text:"Chapter updated successfully",icon:"check",iconClasses:"bg-green-600 text-white rounded-md p-px"}),e()},onError(t){u(t)}})},u=e=>{var t;R({title:"Error",text:((t=e.messages)==null?void 0:t[0])||e,icon:"x",iconClasses:"bg-red-600 text-white rounded-md p-px",position:"top-center",timeout:10})};return F(()=>h.chapterDetail,e=>{n.title=e==null?void 0:e.title}),(e,t)=>(s(),f(l(z),{modelValue:x.value,"onUpdate:modelValue":t[1]||(t[1]=r=>x.value=r),options:{title:e.__("Add Chapter"),size:"lg",actions:[{label:a.chapterDetail?e.__("Edit Chapter"):e.__("Add Chapter"),variant:"solid",onClick:r=>a.chapterDetail?i(r):V(r)}]}},{"body-content":d(()=>[m(l(P),{label:"Title",modelValue:n.title,"onUpdate:modelValue":t[0]||(t[0]=r=>n.title=r),class:"mb-4"},null,8,["modelValue"])]),_:1},8,["modelValue","options"]))}},ee={class:"text-base"},te={key:0,class:"grid grid-cols-[70%,30%] mb-4 px-3"},ae={class:"font-semibold text-lg"},le={class:"text-base text-left font-medium leading-5"},se={class:"outline-lesson pl-8 py-2"},re={class:"flex items-center text-sm leading-5"},oe={key:0,class:"flex mt-2 mb-4 pl-8"},me={__name:"CourseOutline",props:{courseName:{type:String,required:!0},showOutline:{type:Boolean,default:!1},title:{type:String,default:""},allowEdit:{type:Boolean,default:!1}},setup(a){const x=J();E(!0);const y=E(!1),h=E(null),n=a,p=N({url:"lms.lms.utils.get_course_outline",cache:["course_outline",n.courseName],params:{course:n.courseName},auto:!0}),_=i=>i==x.params.chapterNumber||i==1,b=(i=null)=>{h.value=i,y.value=!0},V=()=>h.value;return(i,u)=>{var t,r;const e=H("router-link");return s(),C(D,null,[k("div",ee,[a.title&&((t=l(p).data)!=null&&t.length||a.allowEdit)?(s(),C("div",te,[k("div",ae,g(i.__(a.title)),1),a.allowEdit?(s(),f(l(M),{key:0,size:"sm",onClick:u[0]||(u[0]=o=>b())},{default:d(()=>[w(g(i.__("Add Chapter")),1)]),_:1})):v("",!0)])):v("",!0),k("div",{class:L({"shadow rounded-md pt-2 px-2":a.showOutline&&((r=l(p).data)==null?void 0:r.length)})},[(s(!0),C(D,null,T(l(p).data,(o,$)=>(s(),f(l(j),{key:o.name,defaultOpen:_(o.idx)},{default:d(({open:S})=>[m(l(I),{ref_for:!0,ref:"",class:"flex w-full p-2"},{default:d(()=>[m(l(K),{class:L([{"rotate-90 transform duration-200":S,"duration-200":!S,open:$==1},"h-4 w-4 text-gray-900 stroke-1 mr-2"])},null,8,["class"]),k("div",le,g(o.title),1)]),_:2},1536),m(l(U),null,{default:d(()=>[(s(!0),C(D,null,T(o.lessons,c=>(s(),C("div",{key:c.name},[k("div",se,[m(e,{to:{name:a.allowEdit?"CreateLesson":"Lesson",params:{courseName:a.courseName,chapterNumber:c.number.split(".")[0],lessonNumber:c.number.split(".")[1]}}},{default:d(()=>[k("div",re,[c.icon==="icon-youtube"?(s(),f(l(X),{key:0,class:"h-4 w-4 text-gray-900 stroke-1 mr-2"})):c.icon==="icon-quiz"?(s(),f(l(W),{key:1,class:"h-4 w-4 text-gray-900 stroke-1 mr-2"})):c.icon==="icon-list"?(s(),f(l(Q),{key:2,class:"h-4 w-4 text-gray-900 stroke-1 mr-2"})):v("",!0),w(" "+g(c.title)+" ",1),c.is_complete?(s(),f(l(Z),{key:3,class:"h-4 w-4 text-green-500 stroke-1.5 ml-2"})):v("",!0)])]),_:2},1032,["to"])])]))),128)),a.allowEdit?(s(),C("div",oe,[m(e,{to:{name:"CreateLesson",params:{courseName:a.courseName,chapterNumber:o.idx,lessonNumber:o.lessons.length+1}}},{default:d(()=>[m(l(M),null,{default:d(()=>[w(g(i.__("Add Lesson")),1)]),_:1})]),_:2},1032,["to"]),m(l(M),{class:"ml-2",onClick:c=>b(o)},{default:d(()=>[w(g(i.__("Edit Chapter")),1)]),_:2},1032,["onClick"])])):v("",!0)]),_:2},1024)]),_:2},1032,["defaultOpen"]))),128))],2)]),m(Y,{modelValue:y.value,"onUpdate:modelValue":u[1]||(u[1]=o=>y.value=o),outline:l(p),"onUpdate:outline":u[2]||(u[2]=o=>G(p)?p.value=o:null),course:a.courseName,chapterDetail:V()},null,8,["modelValue","outline","course","chapterDetail"])],64)}}};export{me as _};
//# sourceMappingURL=CourseOutline-k6WN1oWr.js.map
