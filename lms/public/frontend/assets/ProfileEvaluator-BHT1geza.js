var R=Object.defineProperty;var P=Object.getOwnPropertySymbols;var W=Object.prototype.hasOwnProperty,q=Object.prototype.propertyIsEnumerable;var M=(u,r,o)=>r in u?R(u,r,{enumerable:!0,configurable:!0,writable:!0,value:o}):u[r]=o,z=(u,r)=>{for(var o in r||(r={}))W.call(r,o)&&M(u,o,r[o]);if(P)for(var o of P(r))q.call(r,o)&&M(u,o,r[o]);return u};import{s as G,r as C,a as H,k as f,j as J,x as V,y as S,B as n,C as c,A as l,J as K,K as O,F as A,L as X,M as Y,N as d,aD as v,H as E,aa as F,d as Q,ai as y,I as N}from"./frappe-ui-CgFK8870.js";import{d as _,j as Z}from"./index-GARLdoCV.js";import{X as ee}from"./x-KQP2i48Y.js";import{P as ae}from"./plus-CsLQFB36.js";import{C as te}from"./check-t5WR0f1n.js";const le={class:"mt-7 mb-20"},oe={class:"mb-4 text-lg font-semibold text-gray-900"},se={class:""},de={class:"grid grid-cols-3 md:grid-cols-4 gap-4 text-sm text-gray-700 mb-4"},re={class:"grid grid-cols-3 md:grid-cols-4 gap-4 mb-4 group"},ne={class:"grid grid-cols-3 md:grod-cols-4 gap-4 mb-4"},ue={class:"my-10"},ie={class:"mb-4 text-lg font-semibold text-gray-900"},me={class:"grid grid-cols-2 md:grid-cols-4 gap-4"},ce={class:"mb-4 text-lg font-semibold text-gray-900"},pe={key:0,class:"flex items-center bg-green-100 text-green-900 text-sm p-1 rounded-md mb-4 w-fit"},Ve={__name:"ProfileEvaluator",props:{profile:{type:Object,required:!0}},setup(u){var x;const r=Q("$user"),o=u;G(()=>{var e,a,p;((e=r.data)==null?void 0:e.name)!==((a=o.profile.data)==null?void 0:a.name)&&(window.location.href=`/user/${(p=o.profile.data)==null?void 0:p.username}`)});const k=C(0),g=C(null),b=C(null),s=H({day:"",start_time:"",end_time:""}),i=f({url:"lms.lms.api.get_evaluator_details",params:{evaluator:(x=o.profile.data)==null?void 0:x.name},auto:!0,onSuccess(e){e.slots.unavailable_from&&(g.value=e.slots.unavailable_from),e.slots.unavailable_to&&(b.value=e.slots.unavailable_to)}}),j=f({url:"frappe.client.insert",makeParams(e){var a;return{doc:z({doctype:"Evaluator Schedule",parent:(a=i.data)==null?void 0:a.slots.name,parentfield:"schedule",parenttype:"Course Evaluator"},s)}},onSuccess(){_("Success","Slot added successfully","check"),i.reload(),k.value=0,s.day="",s.start_time="",s.end_time=""},onError(e){var a;_("Error",((a=e.messages)==null?void 0:a[0])||e,"x")}}),B=f({url:"frappe.client.set_value",makeParams(e){return{doctype:"Evaluator Schedule",name:e.name,fieldname:e.field,value:e.value}},onSuccess(){_("Success","Availability updated successfully","check")},onError(e){var a;_("Error",((a=e.messages)==null?void 0:a[0])||e,"x")}}),D=f({url:"frappe.client.delete",makeParams(e){return{doctype:"Evaluator Schedule",name:e.name}},onSuccess(){_("Success","Slot deleted successfully","check"),i.reload()},onError(e){var a;_("Error",((a=e.messages)==null?void 0:a[0])||e,"x")}}),U=f({url:"frappe.client.set_value",makeParams(e){var a;return{doctype:"Course Evaluator",name:(a=i.data)==null?void 0:a.slots.name,fieldname:e.field,value:e.value}},onSuccess(){_("Success","Unavailability updated successfully","check")},onError(e){var a;_("Error",((a=e.messages)==null?void 0:a[0])||e,"x")}}),h=(e,a,p)=>{B.submit({name:e,field:a,value:p},{validate(){if(!p)return`Please enter a value for ${Z(a)}`}})},w=()=>{!s.day||!s.start_time||!s.end_time||j.submit()},I=e=>{D.submit({name:e})},L=f({url:"frappe.integrations.doctype.google_calendar.google_calendar.authorize_access",makeParams(){var e;return{g_calendar:(e=i.data)==null?void 0:e.calendar,reauthorize:1}},onSuccess(e){window.open(e.url)}}),$=J(()=>[{label:"Monday",value:"Monday"},{label:"Tuesday",value:"Tuesday"},{label:"Wednesday",value:"Wednesday"},{label:"Thursday",value:"Thursday"},{label:"Friday",value:"Friday"},{label:"Saturday",value:"Saturday"},{label:"Sunday",value:"Sunday"}]);return(e,a)=>{var p,T;return V(),S("div",le,[n("h2",oe,c(e.__("My availability")),1),n("div",se,[n("div",de,[n("div",null,c(e.__("Day")),1),n("div",null,c(e.__("Start Time")),1),n("div",null,c(e.__("End Time")),1)]),l(i).data?(V(!0),S(K,{key:0},O(l(i).data.slots.schedule,t=>(V(),S("div",re,[d(l(y),{type:"select",options:$.value,modelValue:t.day,"onUpdate:modelValue":m=>t.day=m,onFocusout:v(m=>h(t.name,"day",t.day),["stop"])},null,8,["options","modelValue","onUpdate:modelValue","onFocusout"]),d(l(y),{type:"time",modelValue:t.start_time,"onUpdate:modelValue":m=>t.start_time=m,onFocusout:v(m=>h(t.name,"start_time",t.start_time),["stop"])},null,8,["modelValue","onUpdate:modelValue","onFocusout"]),d(l(y),{type:"time",modelValue:t.end_time,"onUpdate:modelValue":m=>t.end_time=m,onFocusout:v(m=>h(t.name,"end_time",t.end_time),["stop"])},null,8,["modelValue","onUpdate:modelValue","onFocusout"]),d(l(ee),{onClick:m=>I(t.name),class:"w-6 h-auto stroke-1.5 text-red-900 rounded-md cursor-pointer p-1 bg-red-100 hidden group-hover:block"},null,8,["onClick"])]))),256)):A("",!0),X(n("div",ne,[d(l(y),{type:"select",options:$.value,modelValue:s.day,"onUpdate:modelValue":a[0]||(a[0]=t=>s.day=t),onFocusout:a[1]||(a[1]=v(t=>w(),["stop"]))},null,8,["options","modelValue"]),d(l(y),{type:"time",modelValue:s.start_time,"onUpdate:modelValue":a[2]||(a[2]=t=>s.start_time=t),onFocusout:a[3]||(a[3]=v(t=>w(),["stop"]))},null,8,["modelValue"]),d(l(y),{type:"time",modelValue:s.end_time,"onUpdate:modelValue":a[4]||(a[4]=t=>s.end_time=t),onFocusout:a[5]||(a[5]=v(t=>w(),["stop"]))},null,8,["modelValue"])],512),[[Y,k.value]]),d(l(N),{onClick:a[6]||(a[6]=t=>k.value=1)},{prefix:E(()=>[d(l(ae),{class:"w-4 h-4 stroke-1.5 text-gray-700"})]),default:E(()=>[F(" "+c(e.__("Add Slot")),1)]),_:1})]),n("div",ue,[n("h2",ie,c(e.__("I am unavailable")),1),n("div",me,[d(l(y),{type:"date",label:e.__("From"),modelValue:g.value,"onUpdate:modelValue":a[7]||(a[7]=t=>g.value=t),onChange:a[8]||(a[8]=v(()=>{l(U).submit({field:"unavailable_from",value:g.value})},["stop"]))},null,8,["label","modelValue"]),d(l(y),{type:"date",label:e.__("To"),modelValue:b.value,"onUpdate:modelValue":a[9]||(a[9]=t=>b.value=t),onChange:a[10]||(a[10]=v(()=>{l(U).submit({field:"unavailable_to",value:b.value})},["stop"]))},null,8,["label","modelValue"])])]),n("div",null,[n("h2",ce,c(e.__("My calendar")),1),(p=l(i).data)!=null&&p.calendar&&((T=l(i).data)!=null&&T.is_authorized)?(V(),S("div",pe,[d(l(te),{class:"h-4 w-4 stroke-1.5 mr-2"}),F(" "+c(e.__("Your calendar is set.")),1)])):A("",!0),d(l(N),{onClick:a[11]||(a[11]=()=>l(L).submit())},{default:E(()=>[F(c(e.__("Authorize Google Calendar Access")),1)]),_:1})])])}}};export{Ve as default};
//# sourceMappingURL=ProfileEvaluator-BHT1geza.js.map
